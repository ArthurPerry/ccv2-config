"use strict";(self.webpackChunkb2bspastore=self.webpackChunkb2bspastore||[]).push([[679],{2732:(st,ee,S)=>{S.d(ee,{Ru:()=>W,gV:()=>K,ir:()=>Q,t1:()=>Lt,yN:()=>L});var c=S(4650),R=S(8555),r=S(8609),m=S(2994),p=S(4850),y=S(2986),C=S(7545),f=S(7221),g=S(4129),z=S(591),Y=S(6053),v=S(1086),B=S(3749),h=S(5024);class K{}let T=(()=>{class e{constructor(t){this.adapter=t}get(t,o){return this.adapter.load(t,o)}getHistory(t,o,i,d){return this.adapter.loadHistory(t,o,i,d)}getConsignmentTracking(t,o,i){return this.adapter.getConsignmentTracking(t,o,i)}cancel(t,o,i){return this.adapter.cancel(t,o,i)}return(t,o){return this.adapter.createReturnRequest(t,o)}getReturnRequestDetail(t,o){return this.adapter.loadReturnRequestDetail(t,o)}getReturnRequestList(t,o,i,d){return this.adapter.loadReturnRequestList(t,o,i,d)}cancelReturnRequest(t,o,i){return this.adapter.cancelReturnRequest(t,o,i)}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(K))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})();class W{}let V=(()=>{class e{constructor(t){this.adapter=t}placeOrder(t,o,i){return this.adapter.placeOrder(t,o,i)}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(W))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})();class Q{}let u=(()=>{class e{constructor(t){this.adapter=t}load(t,o){return this.adapter.load(t,o)}loadReplenishmentDetailsHistory(t,o,i,d,_){return this.adapter.loadReplenishmentDetailsHistory(t,o,i,d,_)}cancelReplenishmentOrder(t,o){return this.adapter.cancelReplenishmentOrder(t,o)}loadHistory(t,o,i,d){return this.adapter.loadHistory(t,o,i,d)}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(Q))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})();class L{}let n=(()=>{class e{constructor(t){this.adapter=t}scheduleReplenishmentOrder(t,o,i,d){return this.adapter.scheduleReplenishmentOrder(t,o,i,d)}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(L))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})();const a="[Order] Load Consignment Tracking",O="[Order] Load Consignment Tracking Success",E="[Order] Clear Consignment Tracking";class D{constructor(s){this.payload=s,this.type=a}}class me{constructor(s){this.payload=s,this.type="[Order] Load Consignment Tracking Fail"}}class fe{constructor(s){this.payload=s,this.type=O}}class ge{constructor(){this.type=E}}const I="cancelOrder",N="cancelReturn",F="cancelReplenishmentOrder",G="[Order] User Orders",k="[Order] Order Return Requests",P="[Order] Return Request Details",w="[Order] User Order Details",q="[Order] User Replenishment Orders",x="[Order] User Replenishment Order Details",re="[Order] Load Order Details",te="[Order] Load Order Details Success",se="[Order] Cancel Order";class Fe extends r.kPG.LoaderLoadAction{constructor(s){super(w),this.payload=s,this.type=re}}class Ie extends r.kPG.LoaderFailAction{constructor(s){super(w,s),this.payload=s,this.type="[Order] Load Order Details Fail"}}class Ne extends r.kPG.LoaderSuccessAction{constructor(s){super(w),this.payload=s,this.type=te}}class Me extends r.kPG.LoaderResetAction{constructor(){super(w),this.type="[Order] Clear Order Details"}}class Ge extends r.kPG.EntityLoadAction{constructor(s){super(r.BzF,I),this.payload=s,this.type=se}}class ke extends r.kPG.EntityFailAction{constructor(s){super(r.BzF,I,s),this.payload=s,this.type="[Order] Cancel Order Fail"}}class we extends r.kPG.EntitySuccessAction{constructor(){super(r.BzF,I),this.type="[Order] Cancel Order Success"}}class qe extends r.kPG.EntityLoaderResetAction{constructor(){super(r.BzF,I),this.type="[Order] Reset Cancel Order Process"}}const ne="[Order] Create Order Return Request",oe="[Order] Load Order Return Request details",ie="[Order] Cancel Order Return Request",ce="[Order] Load User Order Return Request List",de="[Order] Load User Order Return Request List Success";class Qe extends r.kPG.LoaderLoadAction{constructor(s){super(P),this.payload=s,this.type=ne}}class je extends r.kPG.LoaderFailAction{constructor(s){super(P,s),this.payload=s,this.type="[Order] Create Order Return Request Fail"}}class Xe extends r.kPG.LoaderSuccessAction{constructor(s){super(P),this.payload=s,this.type="[Order] Create Order Return Request Success"}}class Je extends r.kPG.LoaderLoadAction{constructor(s){super(P),this.payload=s,this.type=oe}}class Ze extends r.kPG.LoaderFailAction{constructor(s){super(P,s),this.payload=s,this.type="[Order] Load Order Return Request details Fail"}}class er extends r.kPG.LoaderSuccessAction{constructor(s){super(P),this.payload=s,this.type="[Order] Load Order Return Request details Success"}}class rr extends r.kPG.EntityLoadAction{constructor(s){super(r.BzF,N),this.payload=s,this.type=ie}}class tr extends r.kPG.EntityFailAction{constructor(s){super(r.BzF,N,s),this.payload=s,this.type="[Order] Cancel Order Return Request Fail"}}class sr extends r.kPG.EntitySuccessAction{constructor(){super(r.BzF,N),this.type="[Order] Cancel Order Return Request Success"}}class nr extends r.kPG.LoaderLoadAction{constructor(s){super(k),this.payload=s,this.type=ce}}class or extends r.kPG.LoaderFailAction{constructor(s){super(k,s),this.payload=s,this.type="[Order] Load User Order Return Request List Fail"}}class ir extends r.kPG.LoaderSuccessAction{constructor(s){super(k),this.payload=s,this.type=de}}class cr extends r.kPG.LoaderResetAction{constructor(){super(P),this.type="[Order] Clear Order Return Request Details"}}class dr extends r.kPG.LoaderResetAction{constructor(){super(k),this.type="[Order] Clear Order Return Request List"}}class ar extends r.kPG.EntityLoaderResetAction{constructor(){super(r.BzF,N),this.type="[Order] Reset Cancel Return Request Process"}}const ae="[Order] Load User Orders",ue="[Order] Load User Orders Fail",le="[Order] Load User Orders Success";class lr extends r.kPG.LoaderLoadAction{constructor(s){super(G),this.payload=s,this.type=ae}}class Rr extends r.kPG.LoaderFailAction{constructor(s){super(G,s),this.payload=s,this.type=ue}}class pr extends r.kPG.LoaderSuccessAction{constructor(s){super(G),this.payload=s,this.type=le}}class Re extends r.kPG.LoaderResetAction{constructor(){super(G),this.type="[Order] Clear User Orders"}}const pe="[Order] Load Replenishment Order Details",Oe="[Order] Load Replenishment Order Details Success",he="[Order] Cancel Replenishment Order",j="[Order] Cancel Replenishment Order Success";class Sr extends r.kPG.LoaderLoadAction{constructor(s){super(x),this.payload=s,this.type=pe}}class Lr extends r.kPG.LoaderSuccessAction{constructor(s){super(x),this.payload=s,this.type=Oe}}class Cr extends r.kPG.LoaderFailAction{constructor(s){super(x,s),this.payload=s,this.type="[Order] Load Replenishment Order Details Fail"}}class Dr extends r.kPG.LoaderResetAction{constructor(){super(x),this.type="[Order] Clear Replenishment Order Details"}}class mr extends r.kPG.EntityLoadAction{constructor(s){super(r.BzF,F),this.payload=s,this.type=he}}class fr extends r.kPG.EntitySuccessAction{constructor(s){super(r.BzF,F),this.payload=s,this.type=j}}class gr extends r.kPG.EntityFailAction{constructor(s){super(r.BzF,F,s),this.payload=s,this.type="[Order] Cancel Replenishment Order Fail"}}class vr extends r.kPG.EntityLoaderResetAction{constructor(){super(r.BzF,F),this.type="[Order] Clear Cancel Replenishment Order"}}const Ee="[Order] Load User Replenishment Orders",_e="[Order] Load User Replenishment Orders Success";class Pr extends r.kPG.LoaderLoadAction{constructor(s){super(q),this.payload=s,this.type=Ee}}class Ur extends r.kPG.LoaderFailAction{constructor(s){super(q,s),this.payload=s,this.type="[Order] Load User Replenishment Orders Fail"}}class Tr extends r.kPG.LoaderSuccessAction{constructor(s){super(q),this.payload=s,this.type=_e}}class Fr extends r.kPG.LoaderResetAction{constructor(){super(q),this.type="[Order] Clear User Replenishment Orders"}}const U=(0,R.ZF)("order"),Ir=(0,R.P1)(U,e=>e.consignmentTracking),Nr=(0,R.P1)(Ir,e=>e.tracking),Mr=(0,R.P1)(U,e=>e.orderDetail),Gr=(0,R.P1)(Mr,e=>r.kPG.loaderValueSelector(e)),X=(0,R.P1)(U,e=>e.orderReturn),kr=(0,R.P1)(X,e=>r.kPG.loaderValueSelector(e)),wr=(0,R.P1)(X,e=>r.kPG.loaderLoadingSelector(e)),qr=(0,R.P1)(X,e=>r.kPG.loaderSuccessSelector(e)&&!r.kPG.loaderLoadingSelector(e)),Se=(0,R.P1)(U,e=>e.orderReturnList),J=((0,R.P1)(Se,e=>r.kPG.loaderValueSelector(e)),(0,R.P1)(U,e=>e.orders)),xr=(0,R.P1)(J,e=>r.kPG.loaderSuccessSelector(e)),H=((0,R.P1)(J,e=>r.kPG.loaderValueSelector(e)),(0,R.P1)(U,e=>e.replenishmentOrder)),Hr=(0,R.P1)(H,e=>r.kPG.loaderValueSelector(e)),$r=(0,R.P1)(H,e=>r.kPG.loaderLoadingSelector(e)),br=(0,R.P1)(H,e=>r.kPG.loaderSuccessSelector(e)),zr=(0,R.P1)(H,e=>r.kPG.loaderErrorSelector(e)),M=(0,R.P1)(U,e=>e.replenishmentOrders),Yr=((0,R.P1)(M,e=>r.kPG.loaderValueSelector(e)),(0,R.P1)(M,e=>r.kPG.loaderLoadingSelector(e))),Br=(0,R.P1)(M,e=>r.kPG.loaderErrorSelector(e)),Kr=(0,R.P1)(M,e=>r.kPG.loaderSuccessSelector(e));let Wr=(()=>{class e{constructor(t,o,i,d){this.store=t,this.processStateStore=o,this.userIdService=i,this.routingService=d}getOrderDetails(){return this.store.pipe((0,R.Ys)(Gr))}loadOrderDetails(t){this.userIdService.takeUserId().subscribe(o=>{this.store.dispatch(new Fe({userId:o,orderCode:t}))})}clearOrderDetails(){this.store.dispatch(new Me)}getOrderHistoryList(t){return this.store.pipe((0,R.Ys)(J),(0,m.b)(o=>{o.loading||o.success||o.error||this.loadOrderList(t)}),(0,p.U)(o=>o.value))}getOrderHistoryListLoaded(){return this.store.pipe((0,R.Ys)(xr))}loadOrderList(t,o,i){this.userIdService.takeUserId(!0).subscribe(d=>{let _;this.routingService.getRouterState().pipe((0,y.q)(1)).subscribe(A=>{_=A?.state?.params?.replenishmentOrderCode}).unsubscribe(),this.store.dispatch(new lr({userId:d,pageSize:t,currentPage:o,sort:i,replenishmentOrderCode:_}))},()=>{})}clearOrderList(){this.store.dispatch(new Re)}getConsignmentTracking(){return this.store.pipe((0,R.Ys)(Nr))}loadConsignmentTracking(t,o){this.userIdService.takeUserId().subscribe(i=>{this.store.dispatch(new D({userId:i,orderCode:t,consignmentCode:o}))})}clearConsignmentTracking(){this.store.dispatch(new ge)}cancelOrder(t,o){this.userIdService.takeUserId().subscribe(i=>{this.store.dispatch(new Ge({userId:i,orderCode:t,cancelRequestInput:o}))})}getCancelOrderLoading(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessLoadingFactory(I)))}getCancelOrderSuccess(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessSuccessFactory(I)))}resetCancelOrderProcessState(){return this.store.dispatch(new qe)}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(R.yh),c.LFG(R.yh),c.LFG(r.XBV),c.LFG(r.Znh))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})(),Vr=(()=>{class e{constructor(t,o,i){this.store=t,this.processStateStore=o,this.userIdService=i}createOrderReturnRequest(t){this.userIdService.takeUserId().subscribe(o=>{this.store.dispatch(new Qe({userId:o,returnRequestInput:t}))})}getOrderReturnRequest(){return this.store.pipe((0,R.Ys)(kr))}getOrderReturnRequestList(t){return this.store.pipe((0,R.Ys)(Se),(0,m.b)(o=>{o.loading||o.success||o.error||this.loadOrderReturnRequestList(t)}),(0,p.U)(o=>o.value))}loadOrderReturnRequestDetail(t){this.userIdService.takeUserId().subscribe(o=>{this.store.dispatch(new Je({userId:o,returnRequestCode:t}))})}loadOrderReturnRequestList(t,o,i){this.userIdService.takeUserId(!0).subscribe(d=>{this.store.dispatch(new nr({userId:d,pageSize:t,currentPage:o,sort:i}))},()=>{})}clearOrderReturnRequestList(){this.store.dispatch(new dr)}getReturnRequestLoading(){return this.store.pipe((0,R.Ys)(wr))}getReturnRequestSuccess(){return this.store.pipe((0,R.Ys)(qr))}clearOrderReturnRequestDetail(){this.store.dispatch(new cr)}cancelOrderReturnRequest(t,o){this.userIdService.takeUserId().subscribe(i=>{this.store.dispatch(new rr({userId:i,returnRequestCode:t,returnRequestModification:o}))})}getCancelReturnRequestLoading(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessLoadingFactory(N)))}getCancelReturnRequestSuccess(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessSuccessFactory(N)))}resetCancelReturnRequestProcessState(){return this.store.dispatch(new ar)}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(R.yh),c.LFG(R.yh),c.LFG(r.XBV))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})(),Qr=(()=>{class e{constructor(t,o,i,d,_){this.activeCartFacade=t,this.userIdService=o,this.commandService=i,this.orderConnector=d,this.eventService=_,this.placedOrder$=new z.X(void 0),this.placeOrderCommand=this.commandService.create(A=>this.checkoutPreconditions().pipe((0,C.w)(([Z,$])=>this.orderConnector.placeOrder(Z,$,A).pipe((0,m.b)(b=>{this.placedOrder$.next(b),this.eventService.dispatch({userId:Z,cartId:$,cartCode:$,order:b},g.uZ)})))),{strategy:r.flE.CancelPrevious})}checkoutPreconditions(){return(0,Y.aj)([this.userIdService.takeUserId(),this.activeCartFacade.takeActiveCartId(),this.activeCartFacade.isGuestCart()]).pipe((0,y.q)(1),(0,p.U)(([t,o,i])=>{if(!t||!o||t===r.Fds&&!i)throw new Error("Checkout conditions not met");return[t,o]}))}placeOrder(t){return this.placeOrderCommand.execute(t)}getOrderDetails(){return this.placedOrder$.asObservable()}clearPlacedOrder(){this.placedOrder$.next(void 0)}setPlacedOrder(t){this.placedOrder$.next(t)}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(B.bu),c.LFG(r.XBV),c.LFG(r.VDr),c.LFG(V),c.LFG(r.POd))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})(),jr=(()=>{class e{constructor(t,o,i){this.store=t,this.processStateStore=o,this.userIdService=i}loadReplenishmentOrderDetails(t){this.userIdService.takeUserId(!0).subscribe(o=>{this.store.dispatch(new Sr({userId:o,replenishmentOrderCode:t}))},()=>{})}getReplenishmentOrderDetails(){return this.store.pipe((0,R.Ys)(Hr))}getReplenishmentOrderDetailsLoading(){return this.store.pipe((0,R.Ys)($r))}getReplenishmentOrderDetailsSuccess(){return this.store.pipe((0,R.Ys)(br))}getReplenishmentOrderDetailsError(){return this.store.pipe((0,R.Ys)(zr))}clearReplenishmentOrderDetails(){this.store.dispatch(new Dr)}cancelReplenishmentOrder(t){this.userIdService.takeUserId(!0).subscribe(o=>{this.store.dispatch(new mr({userId:o,replenishmentOrderCode:t}))},()=>{})}getCancelReplenishmentOrderLoading(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessLoadingFactory(F)))}getCancelReplenishmentOrderSuccess(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessSuccessFactory(F)))}getCancelReplenishmentOrderError(){return this.processStateStore.pipe((0,R.Ys)(r.VkE.getProcessErrorFactory(F)))}clearCancelReplenishmentOrderProcessState(){this.store.dispatch(new vr)}getReplenishmentOrderHistoryList(t){return this.store.pipe((0,R.Ys)(M),(0,m.b)(o=>{o.loading||o.success||o.error||this.loadReplenishmentOrderList(t)}),(0,p.U)(o=>o.value))}getReplenishmentOrderHistoryListLoading(){return this.store.pipe((0,R.Ys)(Yr))}getReplenishmentOrderHistoryListError(){return this.store.pipe((0,R.Ys)(Br))}getReplenishmentOrderHistoryListSuccess(){return this.store.pipe((0,R.Ys)(Kr))}loadReplenishmentOrderList(t,o,i){this.userIdService.takeUserId(!0).subscribe(d=>{this.store.dispatch(new Pr({userId:d,pageSize:t,currentPage:o,sort:i}))},()=>{})}clearReplenishmentOrderList(){this.store.dispatch(new Fr)}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(R.yh),c.LFG(R.yh),c.LFG(r.XBV))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})(),Xr=(()=>{class e{constructor(t,o,i,d,_,A){this.activeCartFacade=t,this.userIdService=o,this.commandService=i,this.scheduledReplenishmentOrderConnector=d,this.eventService=_,this.orderFacade=A,this.scheduleReplenishmentOrderCommand=this.commandService.create(({form:Z,termsChecked:$})=>this.checkoutPreconditions().pipe((0,C.w)(([b,De])=>this.scheduledReplenishmentOrderConnector.scheduleReplenishmentOrder(De,Z,$,b).pipe((0,m.b)(tt=>{this.orderFacade.setPlacedOrder(tt),this.eventService.dispatch({userId:b,cartId:De,cartCode:De,replenishmentOrder:tt},g.oL)})))),{strategy:r.flE.CancelPrevious})}checkoutPreconditions(){return(0,Y.aj)([this.userIdService.takeUserId(),this.activeCartFacade.takeActiveCartId(),this.activeCartFacade.isGuestCart()]).pipe((0,y.q)(1),(0,p.U)(([t,o,i])=>{if(!t||!o||t===r.Fds&&!i)throw new Error("Order conditions not met");return[t,o]}))}scheduleReplenishmentOrder(t,o){return this.scheduleReplenishmentOrderCommand.execute({termsChecked:o,form:t})}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(B.bu),c.LFG(r.XBV),c.LFG(r.VDr),c.LFG(n),c.LFG(r.POd),c.LFG(g.Vh))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})();const ct=[Vr,{provide:g.U1,useExisting:Vr},Wr,{provide:g.Kr,useExisting:Wr},jr,{provide:g.kp,useExisting:jr},Xr,{provide:g.wT,useExisting:Xr},Qr,{provide:g.Vh,useExisting:Qr}],dt=[(()=>{class e{constructor(t,o,i){this.actions$=t,this.orderConnector=o,this.replenishmentOrderConnector=i,this.loadUserOrders$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(ae),(0,p.U)(d=>d.payload),(0,C.w)(d=>(Boolean(d.replenishmentOrderCode)?this.replenishmentOrderConnector.loadReplenishmentDetailsHistory(d.userId,d.replenishmentOrderCode??"",d.pageSize,d.currentPage,d.sort):this.orderConnector.getHistory(d.userId,d.pageSize,d.currentPage,d.sort)).pipe((0,p.U)(_=>new pr(_)),(0,f.K)(_=>(0,v.of)(new Rr((0,r.cxH)(_)))))))),this.resetUserOrders$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(r.dO9.LANGUAGE_CHANGE),(0,p.U)(()=>new Re)))}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(h.eX),c.LFG(T),c.LFG(u))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(t,o,i){this.actions$=t,this.orderConnector=o,this.globalMessageService=i,this.loadOrderDetails$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(re),(0,p.U)(d=>d.payload),(0,C.w)(d=>this.orderConnector.get(d.userId,d.orderCode).pipe((0,p.U)(_=>new Ne(_)),(0,f.K)(_=>(0,v.of)(new Ie((0,r.cxH)(_)))))))),this.cancelOrder$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(se),(0,p.U)(d=>d.payload),(0,C.w)(d=>this.orderConnector.cancel(d.userId,d.orderCode,d.cancelRequestInput).pipe((0,p.U)(()=>new we),(0,f.K)(_=>(_.error?.errors.forEach(A=>this.globalMessageService.add(A.message,r.xUg.MSG_TYPE_ERROR)),(0,v.of)(new ke((0,r.cxH)(_)))))))))}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(h.eX),c.LFG(T),c.LFG(r.IWp))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(t,o){this.actions$=t,this.orderConnector=o,this.loadConsignmentTracking$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(a),(0,p.U)(i=>i.payload),(0,C.w)(i=>this.orderConnector.getConsignmentTracking(i.orderCode,i.consignmentCode,i.userId).pipe((0,p.U)(d=>new fe(d)),(0,f.K)(d=>(0,v.of)(new me((0,r.cxH)(d))))))))}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(h.eX),c.LFG(T))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(t,o){this.actions$=t,this.orderConnector=o,this.createReturnRequest$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(ne),(0,p.U)(i=>i.payload),(0,C.w)(i=>this.orderConnector.return(i.userId,i.returnRequestInput).pipe((0,p.U)(d=>new Xe(d)),(0,f.K)(d=>(0,v.of)(new je((0,r.cxH)(d)))))))),this.loadReturnRequest$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(oe),(0,p.U)(i=>i.payload),(0,C.w)(i=>this.orderConnector.getReturnRequestDetail(i.userId,i.returnRequestCode).pipe((0,p.U)(d=>new er(d)),(0,f.K)(d=>(0,v.of)(new Ze((0,r.cxH)(d)))))))),this.cancelReturnRequest$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(ie),(0,p.U)(i=>i.payload),(0,C.w)(i=>this.orderConnector.cancelReturnRequest(i.userId,i.returnRequestCode,i.returnRequestModification).pipe((0,p.U)(()=>new sr),(0,f.K)(d=>(0,v.of)(new tr((0,r.cxH)(d)))))))),this.loadReturnRequestList$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(ce),(0,p.U)(i=>i.payload),(0,C.w)(i=>this.orderConnector.getReturnRequestList(i.userId,i.pageSize,i.currentPage,i.sort).pipe((0,p.U)(d=>new ir(d)),(0,f.K)(d=>(0,v.of)(new or((0,r.cxH)(d))))))))}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(h.eX),c.LFG(T))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(t,o,i){this.actions$=t,this.replenishmentOrderConnector=o,this.globalMessageService=i,this.loadReplenishmentOrderDetails$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(pe),(0,p.U)(d=>d.payload),(0,C.w)(d=>this.replenishmentOrderConnector.load(d.userId,d.replenishmentOrderCode).pipe((0,p.U)(_=>new Lr(_)),(0,f.K)(_=>(0,v.of)(new Cr((0,r.cxH)(_)))))))),this.cancelReplenishmentOrder$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(he),(0,p.U)(d=>d.payload),(0,C.w)(d=>this.replenishmentOrderConnector.cancelReplenishmentOrder(d.userId,d.replenishmentOrderCode).pipe((0,p.U)(_=>new fr(_)),(0,f.K)(_=>(_?.error?.errors.forEach(A=>this.globalMessageService.add(A.message,r.xUg.MSG_TYPE_ERROR)),(0,v.of)(new gr((0,r.cxH)(_)))))))))}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(h.eX),c.LFG(u),c.LFG(r.IWp))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})(),(()=>{class e{constructor(t,o){this.actions$=t,this.replenishmentOrderConnector=o,this.loadUserReplenishmentOrders$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(Ee),(0,p.U)(i=>i.payload),(0,C.w)(i=>this.replenishmentOrderConnector.loadHistory(i.userId,i.pageSize,i.currentPage,i.sort).pipe((0,p.U)(d=>new Tr(d)),(0,f.K)(d=>(0,v.of)(new Ur((0,r.cxH)(d))))))))}}return e.\u0275fac=function(t){return new(t||e)(c.LFG(h.eX),c.LFG(u))},e.\u0275prov=c.Yz7({token:e,factory:e.\u0275fac}),e})()],Jr={tracking:{}};function at(e=Jr,s){switch(s.type){case O:return{tracking:s.payload};case E:return Jr}return e}const ut={};function lt(e=ut,s){return s.type===te?s.payload:e}const Zr={returnRequests:[],pagination:{},sorts:[]};function Rt(e=Zr,s){return s.type===de?s.payload?s.payload:Zr:e}const Le={orders:[],pagination:{},sorts:[]};function pt(e=Le,s){switch(s.type){case le:return s.payload?s.payload:Le;case ue:return Le}return e}const et={};function Ot(e=et,s){switch(s.type){case Oe:case j:return s.payload?s.payload:et;default:return e}}const Ce={replenishmentOrders:[],pagination:{},sorts:[]};function ht(e=Ce,s){switch(s.type){case _e:return s.payload?s.payload:Ce;case j:{const t=s.payload,o=[...e.replenishmentOrders??[]],i=o.findIndex(d=>d.replenishmentOrderCode===t.replenishmentOrderCode);return-1===i?Ce:(o[i]={...t},{...e,replenishmentOrders:o})}}return e}const rt=new c.OlP("OrderReducers"),_t={provide:rt,useFactory:function Et(){return{orders:r.kPG.loaderReducer(G,pt),orderDetail:r.kPG.loaderReducer(w,lt),replenishmentOrders:r.kPG.loaderReducer(q,ht),orderReturn:r.kPG.loaderReducer(P),orderReturnList:r.kPG.loaderReducer(k,Rt),consignmentTracking:at,replenishmentOrder:r.kPG.loaderReducer(x,Ot)}}};let St=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({providers:[_t],imports:[h.sQ.forFeature(dt),R.Aw.forFeature("order",rt)]}),e})(),Lt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({providers:[...ct,T,u,V,n],imports:[St]}),e})()},679:(st,ee,S)=>{S.d(ee,{FV:()=>Q,mb:()=>z});var c=S(4650),R=S(3749),r=S(8609),m=S(529),p=S(4129),y=S(1737),C=S(7221),f=S(6895),g=S(2732);let z=(()=>{class u{constructor(n){this.converter=n}convert(n,a){return void 0===a&&(a={...n}),n.entries&&(a.entries=n.entries.map(l=>this.convertOrderEntry(l,n.code,n.appliedProductPromotions))),n.consignments&&(a.consignments=n.consignments.map(l=>({...l,entries:l.entries?.map(O=>({...O,orderEntry:this.convertOrderEntry(O.orderEntry,n.code,n.appliedProductPromotions)}))}))),n.unconsignedEntries&&(a.unconsignedEntries=n.unconsignedEntries.map(l=>this.convertOrderEntry(l,n.code,n.appliedProductPromotions))),a}convertOrderEntry(n,a,l){return{...n,product:this.converter.convert(n?.product,r.jrf),orderCode:a,promotions:this.converter.convert({item:n,promotions:l},R.Cx)}}}return u.\u0275fac=function(n){return new(n||u)(c.LFG(r.IXI))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})(),Y=(()=>{class u{constructor(n){this.converter=n}convert(n,a){return void 0===a&&(a={...n}),n.entries&&(a.entries=n.entries.map(l=>({...l,product:this.converter.convert(l.product,r.jrf),promotions:this.converter.convert({item:l,promotions:n.appliedProductPromotions},R.Cx)}))),a}}return u.\u0275fac=function(n){return new(n||u)(c.LFG(r.IXI))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})(),v=(()=>{class u{constructor(n){this.converter=n}convert(n,a){return void 0===a&&(a={...n}),n.returnEntries&&(a.returnEntries=n.returnEntries.map(l=>({...l,orderEntry:this.convertOrderEntry(l.orderEntry)}))),a}convertOrderEntry(n){return{...n,product:this.converter.convert(n?.product,r.jrf)}}}return u.\u0275fac=function(n){return new(n||u)(c.LFG(r.IXI))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})(),B=(()=>{class u{convert(n,a){return void 0===a&&(a={...n}),n.replenishmentStartDate&&(a.replenishmentStartDate=this.convertDate(n.replenishmentStartDate)),a}convertDate(n){return`${n}T${(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hourCycle:"h23"})}:00${r.IMh.getLocalTimezoneOffset()}`}}return u.\u0275fac=function(n){return new(n||u)},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})(),h=(()=>{class u{constructor(n,a,l){this.http=n,this.occEndpoints=a,this.converter=l}load(n,a){const l=this.occEndpoints.buildUrl("orderDetail",{urlParams:{userId:n,orderId:a}});let O=new m.WM;return n===r.Fds&&(O=r.Fox.createHeader(r._Re,!0,O)),this.http.get(l,{headers:O}).pipe(this.converter.pipeable(p.YA))}loadHistory(n,a,l,O){const E={};a&&(E.pageSize=a.toString()),l&&(E.currentPage=l.toString()),O&&(E.sort=O.toString());const D=this.occEndpoints.buildUrl("orderHistory",{urlParams:{userId:n},queryParams:E});return this.http.get(D).pipe(this.converter.pipeable(p.Rc))}getConsignmentTracking(n,a,l=r.zyp){const O=this.occEndpoints.buildUrl("consignmentTracking",{urlParams:{userId:l,orderCode:n,consignmentCode:a}});return this.http.get(O).pipe(this.converter.pipeable(p.m1))}cancel(n,a,l){const O=this.occEndpoints.buildUrl("cancelOrder",{urlParams:{userId:n,orderId:a}}),E=new m.WM({"Content-Type":"application/json"});return this.http.post(O,l,{headers:E}).pipe((0,C.K)(D=>(0,y._)(D)))}createReturnRequest(n,a){const l=this.occEndpoints.buildUrl("returnOrder",{urlParams:{userId:n}}),O=new m.WM({"Content-Type":"application/json"});return a=this.converter.convert(a,p.Nz),this.http.post(l,a,{headers:O}).pipe((0,C.K)(E=>(0,y._)(E)),this.converter.pipeable(p.Ge))}loadReturnRequestList(n,a,l,O){const E={};a&&(E.pageSize=a.toString()),l&&(E.currentPage=l.toString()),O&&(E.sort=O.toString());const D=this.occEndpoints.buildUrl("orderReturns",{urlParams:{userId:n},queryParams:E});return this.http.get(D).pipe(this.converter.pipeable(p.SL))}loadReturnRequestDetail(n,a){const l=this.occEndpoints.buildUrl("orderReturnDetail",{urlParams:{userId:n,returnRequestCode:a}});return this.http.get(l).pipe(this.converter.pipeable(p.Ge))}cancelReturnRequest(n,a,l){const O=this.occEndpoints.buildUrl("cancelReturn",{urlParams:{userId:n,returnRequestCode:a}}),E=new m.WM({"Content-Type":"application/json"});return this.http.patch(O,l,{headers:E}).pipe((0,C.K)(D=>(0,y._)(D)))}}return u.\u0275fac=function(n){return new(n||u)(c.LFG(m.eN),c.LFG(r.Lz0),c.LFG(r.IXI))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac}),u})(),K=(()=>{class u{constructor(n,a,l){this.http=n,this.occEndpoints=a,this.converter=l}placeOrder(n,a,l){let O=new m.WM({"Content-Type":"application/x-www-form-urlencoded"});return n===r.Fds&&(O=r.Fox.createHeader(r._Re,!0,O)),this.http.post(this.getPlaceOrderEndpoint(n,a,l.toString()),{},{headers:O}).pipe((0,C.K)(E=>(0,y._)((0,r.cxH)(E))),(0,r.twT)({shouldRetry:r.Pzz}),this.converter.pipeable(p.YA))}getPlaceOrderEndpoint(n,a,l){return this.occEndpoints.buildUrl("placeOrder",{urlParams:{userId:n},queryParams:{cartId:a,termsChecked:l}})}}return u.\u0275fac=function(n){return new(n||u)(c.LFG(m.eN),c.LFG(r.Lz0),c.LFG(r.IXI))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac}),u})(),T=(()=>{class u{constructor(n,a,l){this.http=n,this.occEndpoints=a,this.converter=l}load(n,a){return this.http.get(this.occEndpoints.buildUrl("replenishmentOrderDetails",{urlParams:{userId:n,replenishmentOrderCode:a}})).pipe(this.converter.pipeable(p.JD))}loadReplenishmentDetailsHistory(n,a,l,O,E){const D={};return l&&(D.pageSize=l.toString()),O&&(D.currentPage=O.toString()),E&&(D.sort=E.toString()),this.http.get(this.occEndpoints.buildUrl("replenishmentOrderDetailsHistory",{urlParams:{userId:n,replenishmentOrderCode:a},queryParams:D})).pipe(this.converter.pipeable(p.Rc))}cancelReplenishmentOrder(n,a){const l=(new m.WM).set("Content-Type","application/json");return this.http.patch(this.occEndpoints.buildUrl("cancelReplenishmentOrder",{urlParams:{userId:n,replenishmentOrderCode:a}}),{},{headers:l}).pipe(this.converter.pipeable(p.JD))}loadHistory(n,a,l,O){const E={};a&&(E.pageSize=a.toString()),l&&(E.currentPage=l.toString()),O&&(E.sort=O.toString());const D=this.occEndpoints.buildUrl("replenishmentOrderHistory",{urlParams:{userId:n},queryParams:E});return this.http.get(D).pipe(this.converter.pipeable(p.HN))}}return u.\u0275fac=function(n){return new(n||u)(c.LFG(m.eN),c.LFG(r.Lz0),c.LFG(r.IXI))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac}),u})(),W=(()=>{class u{constructor(n,a,l){this.http=n,this.occEndpoints=a,this.converter=l}scheduleReplenishmentOrder(n,a,l,O){a=this.converter.convert(a,p.dC);const E=(new m.WM).set("Content-Type","application/json");return this.http.post(this.getScheduleReplenishmentOrderEndpoint(O,n,l.toString()),a,{headers:E}).pipe((0,C.K)(D=>(0,y._)((0,r.cxH)(D))),(0,r.twT)({shouldRetry:r.Pzz}),this.converter.pipeable(p.JD))}getScheduleReplenishmentOrderEndpoint(n,a,l){return this.occEndpoints.buildUrl("scheduleReplenishmentOrder",{urlParams:{userId:n},queryParams:{cartId:a,termsChecked:l}})}}return u.\u0275fac=function(n){return new(n||u)(c.LFG(m.eN),c.LFG(r.Lz0),c.LFG(r.IXI))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac}),u})();const V={backend:{occ:{endpoints:{orderHistory:"users/${userId}/orders",orderDetail:"users/${userId}/orders/${orderId}?fields=FULL",consignmentTracking:"users/${userId}/orders/${orderCode}/consignments/${consignmentCode}/tracking",cancelOrder:"users/${userId}/orders/${orderId}/cancellation",returnOrder:"users/${userId}/orderReturns?fields=BASIC,returnEntries(BASIC,refundAmount(formattedValue),orderEntry(basePrice(formattedValue),product(name,code,baseOptions,images(DEFAULT,galleryIndex)))),deliveryCost(formattedValue),totalPrice(formattedValue),subTotal(formattedValue)",orderReturns:"users/${userId}/orderReturns?fields=BASIC",orderReturnDetail:"users/${userId}/orderReturns/${returnRequestCode}?fields=BASIC,returnEntries(BASIC,refundAmount(formattedValue),orderEntry(basePrice(formattedValue),product(name,code,baseOptions,images(DEFAULT,galleryIndex)))),deliveryCost(formattedValue),totalPrice(formattedValue),subTotal(formattedValue)",cancelReturn:"users/${userId}/orderReturns/${returnRequestCode}",replenishmentOrderDetails:"users/${userId}/replenishmentOrders/${replenishmentOrderCode}?fields=FULL,costCenter(FULL),purchaseOrderNumber,paymentType,user",replenishmentOrderDetailsHistory:"users/${userId}/replenishmentOrders/${replenishmentOrderCode}/orders",cancelReplenishmentOrder:"users/${userId}/replenishmentOrders/${replenishmentOrderCode}?fields=FULL,costCenter(FULL),purchaseOrderNumber,paymentType,user",replenishmentOrderHistory:"users/${userId}/replenishmentOrders?fields=FULL,replenishmentOrders(FULL, purchaseOrderNumber)",placeOrder:"users/${userId}/orders?fields=FULL"}}}};let Q=(()=>{class u{}return u.\u0275fac=function(n){return new(n||u)},u.\u0275mod=c.oAB({type:u}),u.\u0275inj=c.cJS({providers:[(0,r.i51)(V),{provide:g.gV,useClass:h},{provide:g.ir,useClass:T},{provide:g.Ru,useClass:K},{provide:g.yN,useClass:W},{provide:p.Ge,useExisting:v,multi:!0},{provide:p.YA,useExisting:z,multi:!0},{provide:p.JD,useExisting:Y,multi:!0},{provide:p.dC,useExisting:B,multi:!0}],imports:[f.ez]}),u})()}}]);